serviceMaps:
  serviceName: census-service
  mappings:
    - version: 1.0
      description: Persists census records
      fromTopic: save-census
      isTransaction: true
      queryMaps:
        - query: INSERT INTO eg_cs_census(id, tenantId, hierarchyType, boundaryCode, type, totalPopulation, populationByDemographics, effectiveFrom, effectiveTo, source, additionalDetails, createdBy, lastModifiedBy, createdTime, lastModifiedTime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: Census.*
          jsonMaps:
            - jsonPath: $.Census.*.id
            - jsonPath: $.Census.*.tenantId
            - jsonPath: $.Census.*.hierarchyType
            - jsonPath: $.Census.*.boundaryCode
            - jsonPath: $.Census.*.type
            - jsonPath: $.Census.*.totalPopulation
            - jsonPath: $.Census.*.populationByDemographics
            - jsonPath: $.Census.*.effectiveFrom
            - jsonPath: $.Census.*.effectiveTo
            - jsonPath: $.Census.*.source
            - jsonPath: $.Census.*.additionalDetails
            - jsonPath: $.Census.*.auditDetails.createdBy
            - jsonPath: $.Census.*.auditDetails.lastModifiedBy
            - jsonPath: $.Census.*.auditDetails.createdTime
            - jsonPath: $.Census.*.auditDetails.lastModifiedTime
    - version: 1.0
      description: Update census records
      fromTopic: update-census
      isTransaction: true
      queryMaps:
        - query: UPDATE eg_cs_census SET totalPopulation=?, populationByDemographics=?, effectiveFrom=?, effectiveTo=?, source=?, additionalDetails=?, lastModifiedBy=?, lastModifiedTime=? WHERE id=?;
          basePath: Census.*
          jsonMaps:
            - jsonPath: $.Census.*.totalPopulation
            - jsonPath: $.Census.*.populationByDemographics
            - jsonPath: $.Census.*.effectiveFrom
            - jsonPath: $.Census.*.effectiveTo
            - jsonPath: $.Census.*.source
            - jsonPath: $.Census.*.additionalDetails
            - jsonPath: $.Census.*.auditDetails.lastModifiedBy
            - jsonPath: $.Census.*.auditDetails.lastModifiedTime
            - jsonPath: $.Census.*.id
